<Window x:Class="HouseholdAccountBook.Views.Windows.DbSettingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:project="clr-namespace:HouseholdAccountBook"
        xmlns:properties="clr-namespace:HouseholdAccountBook.Properties"
        xmlns:vmw="clr-namespace:HouseholdAccountBook.ViewModels.Windows"
        xmlns:enums="clr-namespace:HouseholdAccountBook.Enums"
        mc:Ignorable="d"
        Title="{x:Static properties:Resources.Title_DbSettingWindow}" Height="370" Width="400" WindowStyle="ToolWindow">
    <Window.DataContext>
        <vmw:DbSettingWindowViewModel x:Name="WVM"/>
    </Window.DataContext>

    <Window.InputBindings>
        <KeyBinding Gesture="Enter" Command="{Binding OKCommand}"/>
        <KeyBinding Gesture="Esc" Command="{Binding CancelCommand}"/>
    </Window.InputBindings>

    <Grid Margin="5" Grid.IsSharedSizeScope="True">
        <Grid.ColumnDefinitions>
            <ColumnDefinition SharedSizeGroup="Header"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Margin="5" VerticalAlignment="Center"
                   Text="{Binding Message}"/>

        <TextBlock Grid.Row="1" Grid.Column="0" Margin="5"
                   Text="{x:Static properties:Resources.TextBlock_DBKind}"/>
        <ComboBox Grid.Row="1" Grid.Column="1" Margin="5" VerticalAlignment="Center"
                  ItemsSource="{Binding DBKindDic}" SelectedValue="{Binding SelectedDBKind}" SelectedValuePath="Key" DisplayMemberPath="Value"/>

        <!-- PostgreSQL -->
        <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
            <Grid.Style>
                <Style TargetType="Grid">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding SelectedDBKind}" Value="PostgreSQL">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            <GroupBox Header="{x:Static properties:Resources.GroupHeader_PostgreSQL}" DataContext="{Binding PostgreSQLDBSettingVM}">
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition SharedSizeGroup="Header"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="25" SharedSizeGroup="Button"/>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_Npgsql_Host}" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="1" Text="{Binding Host}"/>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_Npgsql_Port}" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Margin="1" Text="{Binding Port}" 
                         PreviewTextInput="TextBox_PreviewTextInput"/>

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_Npgsql_UserName}" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Margin="1" Text="{Binding UserName}"/>

                    <TextBlock Grid.Row="3" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_Npgsql_Password}" Margin="5" VerticalAlignment="Center"/>
                    <PasswordBox x:Name="passwordBox" Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" Margin="1"/>

                    <TextBlock Grid.Row="4" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_Npgsql_DbName}" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" Margin="1" Text="{Binding DatabaseName}"/>

                    <TextBlock Grid.Row="5" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_Npgsql_Roll}" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="2" Margin="1" Text="{Binding Role}"/>

                    <TextBlock Grid.Row="6" Grid.Column="0" Text="pg_dump.exe" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="6" Grid.Column="1" Margin="1" Text="{Binding DumpExePath}" IsReadOnly="True"/>
                    <Button Grid.Row="6" Grid.Column="2" Margin="1" Content="..."
                            Command="{Binding DataContext.SelectFilePathCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                            CommandParameter="{x:Static enums:FilePathKind.DumpExeFile}"/>

                    <TextBlock Grid.Row="7" Grid.Column="0" Text="pg_restore.exe" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="7" Grid.Column="1" Margin="1" Text="{Binding RestoreExePath}" IsReadOnly="True"/>
                    <Button Grid.Row="7" Grid.Column="2" Margin="1" Content="..." 
                            Command="{Binding DataContext.SelectFilePathCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                            CommandParameter="{x:Static enums:FilePathKind.RestoreExeFile}"/>

                </Grid>
            </GroupBox>
        </Grid>

        <!-- Access -->
        <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
            <Grid.Style>
                <Style TargetType="Grid">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding SelectedDBKind}" Value="Access">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            <GroupBox Header="{x:Static properties:Resources.GroupHeader_Access}" DataContext="{Binding AccessSettingVM}">
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition SharedSizeGroup="Header"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition SharedSizeGroup="Button"/>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Margin="5" 
                               Text="{x:Static properties:Resources.TextBlock_Access_Provider}"/>
                    <ComboBox Grid.Row="0" Grid.Column="1" Margin="5" 
                               ItemsSource="{Binding ProviderNameDic}" SelectedValue="{Binding SelectedProviderName, Mode=TwoWay}" SelectedValuePath="Key" DisplayMemberPath="Value"/>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_Access_DBFilePath}" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Margin="1" Text="{Binding DBFilePath}" IsReadOnly="True"/>
                    <Button Grid.Row="1" Grid.Column="2" Margin="1" Content="..."
                            Command="{Binding DataContext.SelectFilePathCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                            CommandParameter="{x:Static enums:FilePathKind.DbFile}"/>
                </Grid>
            </GroupBox>
        </Grid>

        <!-- SQLite -->
        <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
            <Grid.Style>
                <Style TargetType="Grid">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding SelectedDBKind}" Value="SQLite">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            <GroupBox Header="{x:Static properties:Resources.GroupHeader_SQLite}" DataContext="{Binding SQLiteSettingVM}">
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition SharedSizeGroup="Header"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition SharedSizeGroup="Button"/>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="{x:Static properties:Resources.TextBlock_SQLite_DBFilePath}" Margin="5" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Margin="1" Text="{Binding DBFilePath}" IsReadOnly="True"/>
                    <Button Grid.Row="0" Grid.Column="2" Margin="1" Content="..." 
                            Command="{Binding DataContext.SelectFilePathCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                            CommandParameter="{x:Static enums:FilePathKind.DbFile}"/>
                </Grid>
            </GroupBox>
        </Grid>
        
        <Grid Grid.Row="3" Grid.ColumnSpan="3" Margin="0,5,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.5*"/>
                <ColumnDefinition Width="0.5*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0" Margin="5" Content="{x:Static properties:Resources.Button_OK}" Command="{Binding OKCommand}"/>
            <Button Grid.Column="1" Margin="5" Content="{x:Static properties:Resources.Button_Cancel}" Command="{Binding CancelCommand}"/>
        </Grid>
    </Grid>
</Window>
