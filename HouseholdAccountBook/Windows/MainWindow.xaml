<Window x:Class="HouseholdAccountBook.Windows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:project="clr-namespace:HouseholdAccountBook"
        xmlns:viewmodels="clr-namespace:HouseholdAccountBook.ViewModels"
        xmlns:controls="clr-namespace:HouseholdAccountBook.UserControls"
        xmlns:properties="clr-namespace:HouseholdAccountBook.Properties"
        xmlns:converters="clr-namespace:HouseholdAccountBook.Converters"
        xmlns:behaviors="clr-namespace:HouseholdAccountBook.Behaviors"
        mc:Ignorable="d"
        Title="Hausehold Account Book" Height="700" Width="1050"
        Loaded="MainWindow_Loaded"
        Closing="MainWindow_Closing">

    <Window.Resources>
        <!-- ファイル操作コマンド -->
        <RoutedCommand x:Key="ImportKichoHugetsuDbCommand"/>
        <RoutedCommand x:Key="ImportCustomFileCommand"/>
        <RoutedCommand x:Key="ExportExcelFileCommand"/>
        <RoutedCommand x:Key="ExportCustomFileCommand"/>

        <!-- 帳簿項目操作コマンド -->
        <RoutedCommand x:Key="MoveToBookCommand"/>
        <RoutedCommand x:Key="AddActionToBookCommand"/>
        <RoutedCommand x:Key="AddActionListToBookCommand"/>
        <RoutedCommand x:Key="EditActionCommand"/>
        <RoutedCommand x:Key="DeleteActionCommand"/>

        <!-- タブ表示操作コマンド -->
        <RoutedCommand x:Key="IndicateBookCommand"/>
        <RoutedCommand x:Key="IndicateListCommand"/>
        <RoutedCommand x:Key="IndicateGraphCommand"/>
        <RoutedCommand x:Key="IndicateSettingCommand"/>

        <!-- 帳簿表示操作コマンド -->
        <RoutedCommand x:Key="GoToLastMonthCommand"/>
        <RoutedCommand x:Key="GoToThisMonthCommand"/>
        <RoutedCommand x:Key="GoToNextMonthCommand"/>

        <!-- 年間一覧表示操作コマンド -->
        <RoutedCommand x:Key="GoToLastYearCommand"/>
        <RoutedCommand x:Key="GoToThisYearCommand"/>
        <RoutedCommand x:Key="GoToNextYearCommand"/>

        <!-- コンバータ -->
        <converters:IntToMoneyDisplayConverter x:Key="IntToMoneyDisplayConverter"/>
        <converters:DateTimeToDisplayedMonthConverter x:Key="DateTimeToThisMonthConverter"/>
        <converters:DateTimeToDisplayedYearConverter x:Key="DateTimeToThisYearConverter"/>
        <converters:DateTimeToActTimeConverter x:Key="DateTimeToActTimeConverter"/>
        <converters:DateTimeToDayOfWeekConverter x:Key="DateTimeToDayOfWeekConverter"/>
        <BooleanToVisibilityConverter x:Key="BoolVisibilityConverter"/>

        <!-- スタイル -->
        <Style x:Key="TextAlignRight" TargetType="TextBlock">
            <Setter Property="TextAlignment" Value="Right"/>
        </Style>

        <Style x:Key="SummaryStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="#FFEEE3FB"/>
            <Style.Triggers>
                <!-- カテゴリ小計 -->
                <DataTrigger Binding="{Binding ItemId}" Value="-1">
                    <Setter Property="Background" Value="#FFFFFFB0"/>
                </DataTrigger>
                <!-- 収支小計 -->
                <DataTrigger Binding="{Binding CategoryId}" Value="-1">
                    <Setter Property="Background" Value="#FFB0FFB0"/>
                </DataTrigger>
                <!-- 差引損益 -->
                <DataTrigger Binding="{Binding BalanceKind}" Value="-1">
                    <Setter Property="Background" Value="#FFFFB0B0"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DayOfWeekStyle" TargetType="DataGridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ActTime, Converter={StaticResource DateTimeToDayOfWeekConverter}}" Value="土">
                    <Setter Property="Foreground" Value="Blue"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ActTime, Converter={StaticResource DateTimeToDayOfWeekConverter}}" Value="日">
                    <Setter Property="Foreground" Value="Red"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="FutureStyle" TargetType="DataGridRow">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsFuture}" Value="True">
                    <Setter Property="Foreground" Value="Gray"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- 設定 -->
        <properties:Settings x:Key="Settings"/>
    </Window.Resources>

    <Window.CommandBindings>
        <!-- フォーム操作コマンド -->
        <CommandBinding Command="{x:Static ApplicationCommands.Close}" Executed="CloseWindowCommand_Executed"/>

        <!-- ファイル操作コマンド -->
        <CommandBinding Command="{StaticResource ImportKichoHugetsuDbCommand}" Executed="ImportKichoHugetsuDbCommand_Executed"/>
        <CommandBinding Command="{StaticResource ImportCustomFileCommand}" CanExecute="ImportCustomFileCommand_CanExecute" Executed="ImportCustomFileCommand_Excuted"/>
        <CommandBinding Command="{StaticResource ExportExcelFileCommand}"/>
        <CommandBinding Command="{StaticResource ExportCustomFileCommand}" CanExecute="ExportCustomFileCommand_CanExecute" Executed="ExportCustomFileCommand_Excuted"/>

        <!-- 帳簿項目操作コマンド -->
        <CommandBinding Command="{StaticResource MoveToBookCommand}" CanExecute="MoveToBookCommand_CanExecute" Executed="MoveToBookCommand_Executed"/>
        <CommandBinding Command="{StaticResource AddActionToBookCommand}" CanExecute="AddActionToBookCommand_CanExecute" Executed="AddActionToBookCommand_Executed"/>
        <CommandBinding Command="{StaticResource EditActionCommand}" CanExecute="EditActionCommand_CanExecute" Executed="EditActionCommand_Executed"/>
        <CommandBinding Command="{StaticResource AddActionListToBookCommand}" CanExecute="AddActionListToBookCommand_CanExecute" Executed="AddActionListToBookCommand_Executed"/>
        <CommandBinding Command="{StaticResource DeleteActionCommand}" CanExecute="DeleteActionCommand_CanExecute" Executed="DeleteActionCommand_Executed"/>
        
        <!-- タブ表示操作コマンド -->
        <CommandBinding Command="{StaticResource IndicateBookCommand}" CanExecute="IndicateBookCommand_CanExecute" Executed="IndicateBookCommand_Executed"/>
        <CommandBinding Command="{StaticResource IndicateListCommand}" CanExecute="IndicateListCommand_CanExecute" Executed="IndicateListCommand_Executed"/>
        <CommandBinding Command="{StaticResource IndicateGraphCommand}" CanExecute="IndicateGraphCommand_CanExecute" Executed="IndicateGraphCommand_Executed"/>
        <CommandBinding Command="{StaticResource IndicateSettingCommand}" CanExecute="IndicateSettingCommand_CanExecute" Executed="IndicateSettingCommand_Executed"/>
        
        <!-- 帳簿表示操作コマンド -->
        <CommandBinding Command="{StaticResource GoToLastMonthCommand}" CanExecute="GoToLastMonthCommand_CanExecute" Executed="GoToLastMonthCommand_Executed"/>
        <CommandBinding Command="{StaticResource GoToThisMonthCommand}" CanExecute="GoToThisMonthCommand_CanExecute" Executed="GoToThisMonthCommand_Executed"/>
        <CommandBinding Command="{StaticResource GoToNextMonthCommand}" CanExecute="GoToNextMonthCommand_CanExecute" Executed="GoToNextMonthCommand_Executed"/>

        <!-- 年間一覧表示操作コマンド -->
        <CommandBinding Command="{StaticResource GoToLastYearCommand}" CanExecute="GoToLastYearCommand_CanExecute" Executed="GoToLastYearCommand_Executed"/>
        <CommandBinding Command="{StaticResource GoToThisYearCommand}" CanExecute="GoToThisYearCommand_CanExecute" Executed="GoToThisYearCommand_Executed"/>
        <CommandBinding Command="{StaticResource GoToNextYearCommand}" CanExecute="GoToNextYearCommand_CanExecute" Executed="GoToNextYearCommand_Executed"/>
    </Window.CommandBindings>
    
    <Window.DataContext>
        <viewmodels:MainWindowViewModel x:Name="MainWindowVM"/>
    </Window.DataContext>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1.0*"/>
        </Grid.ColumnDefinitions>

        <!-- メニュー -->
        <Menu Grid.Row="0" Grid.Column="0">
            <MenuItem Header="ファイル(_F)">
                <MenuItem Header="インポート(_I)">
                    <MenuItem Header="記帳風月からインポート(_K)" Command="{StaticResource ImportKichoHugetsuDbCommand}"/>
                    <MenuItem Header="カスタム形式ファイルからインポート(_S)" Command="{StaticResource ImportCustomFileCommand}"/>
                </MenuItem>
                <MenuItem Header="エクスポート(_E)">
                    <MenuItem Header="カスタム形式ファイルにエクスポート(_S)" Command="{StaticResource ExportCustomFileCommand}"/>
                    <MenuItem Header="Excelにエクスポート(_E)" Command="{StaticResource ExportExcelFileCommand}" IsEnabled="False"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="終了(_X)" Command="{x:Static ApplicationCommands.Close}"/>
            </MenuItem>
            <MenuItem Header="編集(_E)">
                <MenuItem Header="移動(_T)" Command="{StaticResource MoveToBookCommand}"/>
                <Separator/>
                <MenuItem Header="追加(_A)" Command="{StaticResource AddActionToBookCommand}"/>
                <MenuItem Header="まとめて追加(_W)" Command="{StaticResource AddActionListToBookCommand}"/>
                <MenuItem Header="変更(_E)" Command="{StaticResource EditActionCommand}"/>
                <MenuItem Header="削除(_D)" Command="{StaticResource DeleteActionCommand}"/>
            </MenuItem>
            <MenuItem Header="表示(_V)">
                <MenuItem Header="帳簿(_B)" Command="{StaticResource IndicateBookCommand}"/>
                <MenuItem Header="年間一覧(_L)" Command="{StaticResource IndicateListCommand}"/>
                <MenuItem Header="グラフ(_G)" Command="{StaticResource IndicateGraphCommand}"/>
            </MenuItem>
            <MenuItem Header="ツール(_T)">
                <MenuItem Header="設定(_S)" Command="{StaticResource IndicateSettingCommand}"/>
            </MenuItem>
            <MenuItem Header="ヘルプ(_H)">
                <MenuItem Header="バージョン情報(_V)"/>
            </MenuItem>
        </Menu>

        <TabControl Grid.Row="1" Grid.Column="0" Width="Auto" Height="Auto" TabStripPlacement="Left"
                    SelectedIndex="{Binding SelectedTabIndex}" SelectionChanged="TabControl_SelectionChanged">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem">
                    <Setter Property="Height" Value="100"/>
                </Style>
            </TabControl.ItemContainerStyle>
            <TabItem Header="帳簿">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="1.0*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- 中央メニュー -->
                    <ScrollViewer Grid.Row="0" Grid.Column="0" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Hidden">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="1.0*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <Button Content="◀" Width="20" Command="{StaticResource GoToLastMonthCommand}"/>
                                <Button Content="{Binding DisplayedMonth, Converter={StaticResource DateTimeToThisMonthConverter}}" Width="120"/>
                                <Button Content="▶" Width="20" Command="{StaticResource GoToNextMonthCommand}"/>
                                <Button Content="今月" Width="40" Command="{StaticResource GoToThisMonthCommand}"/>
                                <ComboBox HorizontalAlignment="Stretch" Margin="5,0" MinWidth="100"
                                            ItemsSource="{Binding BookVMList}" SelectedItem="{Binding SelectedBookVM}" DisplayMemberPath="Name" 
                                            SelectionChanged="BookComboBox_SelectionChanged"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2" Orientation="Horizontal">
                                <Button Content="移動" Width="50" Command="{StaticResource MoveToBookCommand}"/>
                                <Button Content="追加" Width="50" Command="{StaticResource AddActionToBookCommand}"/>
                                <Button Content="まとめて追加" Width="80" Command="{StaticResource AddActionListToBookCommand}"/>
                                <Button Content="変更" Width="50" Command="{StaticResource EditActionCommand}"/>
                                <Button Content="削除" Width="50" Command="{StaticResource DeleteActionCommand}"/>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>

                    <!-- データリスト -->
                    <Grid Grid.Row="1" Grid.Column="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1.0*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- 帳簿項目リスト -->
                        <DataGrid x:Name="actionDataGrid" Grid.Column="0" SelectionMode="Extended"
                                  ItemsSource="{Binding DisplayedActionVMList}" SelectedItem="{Binding SelectedActionVM}" IsReadOnly="True" SelectionUnit="FullRow"
                                  CanUserAddRows="False" CanUserDeleteRows="False" CanUserResizeRows="False" FrozenColumnCount="3"
                                  AutoGenerateColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="True" CanUserSortColumns="True"
                                  HorizontalGridLinesBrush="#FFF0F0F0" VerticalGridLinesBrush="#FFF0F0F0" AlternatingRowBackground="#FFFFFFE0" FontSize="10.5" FontFamily="Meiryo"
                                  ItemContainerStyle="{StaticResource FutureStyle}">
                            <DataGrid.Resources>
                                <project:BindingProxy x:Key="Proxy" DataContext="{Binding}"/>
                            </DataGrid.Resources>
                            <DataGrid.InputBindings>
                                <KeyBinding Gesture="Enter" Command="{StaticResource EditActionCommand}"/>
                                <KeyBinding Gesture="Delete" Command="{StaticResource DeleteActionCommand}"/>
                                <KeyBinding Gesture="Ctrl+OEMPlus" Command="{StaticResource AddActionToBookCommand}"/>
                                <KeyBinding Gesture="Ctrl+Add" Command="{StaticResource AddActionToBookCommand}"/>
                                <KeyBinding Gesture="Shift+Ctrl+OEMPlus" Command="{StaticResource AddActionListToBookCommand}"/>
                                <KeyBinding Gesture="Shift+Ctrl+Add" Command="{StaticResource AddActionListToBookCommand}"/>
                                <KeyBinding Gesture="Ctrl+M" Command="{StaticResource MoveToBookCommand}"/>
                                <MouseBinding Gesture="LeftDoubleClick" Command="{StaticResource EditActionCommand}"/>
                            </DataGrid.InputBindings>
                            <i:Interaction.Behaviors>
                                <behaviors:BindSelectedItemsToDataGridBehavior SelectedItems="{Binding SelectedActionVMList, Mode=OneWay}"/>
                            </i:Interaction.Behaviors>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="アクションID" Binding="{Binding ActionId}"
                                                    Visibility="{Binding DataContext.IsDebug, Source={StaticResource Proxy}, Converter={StaticResource BoolVisibilityConverter}}"/>
                                <DataGridTextColumn Header="日付" Binding="{Binding ActTime, Converter={StaticResource DateTimeToActTimeConverter}}"/>
                                <DataGridTextColumn Header="曜日" Binding="{Binding ActTime, Converter={StaticResource DateTimeToDayOfWeekConverter}}"
                                                    CellStyle="{StaticResource DayOfWeekStyle}"/>
                                <DataGridTextColumn Header="項目名" Binding="{Binding ItemName}"/>
                                <DataGridTextColumn Header="収入" Binding="{Binding Income, Converter={StaticResource IntToMoneyDisplayConverter}}" 
                                        ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="支出" Binding="{Binding Outgo, Converter={StaticResource IntToMoneyDisplayConverter}}" 
                                        ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="残高" Binding="{Binding Balance, Converter={StaticResource IntToMoneyDisplayConverter}}" 
                                        ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="店名" Binding="{Binding ShopName}"/>
                                <DataGridTextColumn Header="備考" Binding="{Binding Remark}"/>
                                <DataGridTextColumn Header="グループID" Binding="{Binding GroupId}" 
                                                    Visibility="{Binding DataContext.IsDebug, Source={StaticResource Proxy}, Converter={StaticResource BoolVisibilityConverter}}"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <GridSplitter Grid.Column="0" Width="5" ResizeDirection="Columns" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>

                        <!-- サマリーリスト -->
                        <DataGrid Grid.Column="1" ItemsSource="{Binding SummaryVMList}" SelectedItem="{Binding SelectedSummaryVM}" 
                                  IsReadOnly="True" SelectionUnit="FullRow" SelectionMode="Single"
                                  CanUserAddRows="False" CanUserDeleteRows="False" CanUserResizeRows="False"
                                  AutoGenerateColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="True" CanUserSortColumns="True"
                                  HorizontalGridLinesBrush="#FFC0C0C0" VerticalGridLinesBrush="#FFC0C0C0" FontSize="10.5" FontFamily="Meiryo"
                                  ItemContainerStyle="{StaticResource SummaryStyle}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="項目名" Binding="{Binding ItemName}"/>
                                <DataGridTextColumn Header="合計" Binding="{Binding Summary, Converter={StaticResource IntToMoneyDisplayConverter}}" 
                                        ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>

                    <!-- ステータスバー -->
                    <StatusBar Grid.Row="2" Grid.Column="0">
                        <StatusBarItem>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <TextBlock>
                                    平均：
                                    <TextBlock Text="{Binding AverageValue, TargetNullValue='--', Converter={StaticResource IntToMoneyDisplayConverter}}"/>
                                    データの個数：
                                    <TextBlock Text="{Binding Amount, TargetNullValue='--'}"/>
                                    合計： 
                                    <TextBlock Text="{Binding SumValue, TargetNullValue='--', Converter={StaticResource IntToMoneyDisplayConverter}}"/>
                                </TextBlock>
                            </StackPanel>
                        </StatusBarItem>
                    </StatusBar>
                </Grid>
            </TabItem>
            <TabItem Header="年間&#10;一覧">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 中央メニュー -->
                    <Grid Grid.Row="0">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="◀" Width="20" Command="{StaticResource GoToLastYearCommand}"/>
                            <Button Content="{Binding DisplayedYear, Converter={StaticResource DateTimeToThisYearConverter}}" Width="120"/>
                            <Button Content="▶" Width="20" Command="{StaticResource GoToNextYearCommand}"/>
                            <Button Content="今年" Width="40" Command="{StaticResource GoToThisYearCommand}"/>
                            <ComboBox HorizontalAlignment="Stretch" Margin="5,0" MinWidth="100"
                                          ItemsSource="{Binding BookVMList}" SelectedItem="{Binding SelectedBookVM}" DisplayMemberPath="Name" 
                                          SelectionChanged="BookComboBox_SelectionChanged"/>
                        </StackPanel>
                    </Grid>

                    <!-- データリスト -->
                    <Grid Grid.Row="1" Background="White">
                        <DataGrid Grid.Column="1" ItemsSource="{Binding SummaryWithinYearVMList}" IsReadOnly="True" SelectionUnit="FullRow"
                                  CanUserAddRows="False" CanUserDeleteRows="False" CanUserResizeRows="False" FrozenColumnCount="1"
                                  AutoGenerateColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="True" CanUserSortColumns="False"
                                  HorizontalGridLinesBrush="#FFC0C0C0" VerticalGridLinesBrush="#FFC0C0C0" FontSize="10.5" FontFamily="Meiryo"
                                  ItemContainerStyle="{StaticResource SummaryStyle}">
                            <DataGrid.Resources>
                                <project:BindingProxy x:Key="Proxy" DataContext="{Binding}"/>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <!-- 参考：http://oita.oika.me/2014/05/31/binding-datagridcolumn/ -->
                                <DataGridTextColumn Header="項目名" Binding="{Binding ItemName}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[0], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[0], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[1], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[1], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[2], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[2], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[3], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[3], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[4], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[4], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[5], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[5], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[6], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[6], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[7], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[7], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[8], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[8], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[9], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[9], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[10], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[10], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="{Binding DataContext.DisplayedMonths[11], Source={StaticResource Proxy}}" 
                                                    Binding="{Binding Values[11], Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="平均" Binding="{Binding Average, Converter={StaticResource IntToMoneyDisplayConverter}}"
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                                <DataGridTextColumn Header="合計" Binding="{Binding Summary, Converter={StaticResource IntToMoneyDisplayConverter}}" 
                                                    ElementStyle="{StaticResource TextAlignRight}" Width="{Binding App_ColumnWidth_Value, Source={StaticResource Settings}}"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="グラフ" IsEnabled="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 中央メニュー -->
                    <Grid Grid.Row="0" Background="LightGray">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="◀" Width="20" Command="{StaticResource GoToLastYearCommand}"/>
                            <Button Content="{Binding DisplayedYear, Converter={StaticResource DateTimeToThisYearConverter}}" Width="120"/>
                            <Button Content="▶" Width="20" Command="{StaticResource GoToNextYearCommand}"/>
                            <Button Content="今年" Width="40" Command="{StaticResource GoToThisYearCommand}"/>
                            <ComboBox HorizontalAlignment="Stretch" Margin="5,0" 
                                              ItemsSource="{Binding BookVMList}" SelectedItem="{Binding SelectedBookVM}" DisplayMemberPath="Name" 
                                              SelectionChanged="BookComboBox_SelectionChanged"/>
                        </StackPanel>
                    </Grid>

                    <!-- データリスト -->
                    <Grid Grid.Row="1" Background="White">
                        <!-- 開発中 -->
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="設定">
                <TabItem.DataContext>
                    <viewmodels:SettingsViewModel x:Name="SettingsVM"/>
                </TabItem.DataContext>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TabControl Grid.Row="0" TabStripPlacement="Left"
                                SelectedIndex="{Binding SelectedTabIndex}" SelectionChanged="SettingsTabControl_SelectionChanged">
                        <TabItem Header="項目設定">
                            <TabItem.Resources>
                                <!-- 設定操作コマンド -->
                                <RoutedCommand x:Key="AddCategoryCommand"/>
                                <RoutedCommand x:Key="AddItemCommand"/>
                                <RoutedCommand x:Key="DeleteItemCommand"/>
                                <RoutedCommand x:Key="RaiseItemSortOrderCommand"/>
                                <RoutedCommand x:Key="DropItemSortOrderCommand"/>
                                <RoutedCommand x:Key="SaveItemInfoCommand"/>
                                <RoutedCommand x:Key="ChangeItemRelationCommand"/>
                                <RoutedCommand x:Key="DeleteShopNameCommand"/>
                                <RoutedCommand x:Key="DeleteRemarkCommand"/>
                            </TabItem.Resources>
                            <TabItem.CommandBindings>
                                <!-- 項目設定操作コマンド -->
                                <CommandBinding Command="{StaticResource AddCategoryCommand}" CanExecute="AddCategoryCommand_CanExecute" Executed="AddCategoryCommand_Executed"/>
                                <CommandBinding Command="{StaticResource AddItemCommand}" CanExecute="AddItemCommand_CanExecute" Executed="AddItemCommand_Executed"/>
                                <CommandBinding Command="{StaticResource DeleteItemCommand}" CanExecute="DeleteItemCommand_CanExecute" Executed="DeleteItemCommand_Executed"/>
                                <CommandBinding Command="{StaticResource RaiseItemSortOrderCommand}" CanExecute="RaiseItemSortOrderCommand_CanExecute" Executed="RaiseItemSortOrderCommand_Executed"/>
                                <CommandBinding Command="{StaticResource DropItemSortOrderCommand}" CanExecute="DropItemSortOrderCommand_CanExecute" Executed="DropItemSortOrderCommand_Executed"/>
                                <CommandBinding Command="{StaticResource SaveItemInfoCommand}" CanExecute="SaveItemInfoCommand_CanExecute" Executed="SaveItemInfoCommand_Executed"/>
                                <CommandBinding Command="{StaticResource ChangeItemRelationCommand}" Executed="ChangeItemRelationCommand_Executed"/>
                                <CommandBinding Command="{StaticResource DeleteShopNameCommand}" CanExecute="DeleteShopNameCommand_CanExecute" Executed="DeleteShopNameCommand_Executed"/>
                                <CommandBinding Command="{StaticResource DeleteRemarkCommand}" CanExecute="DeleteRemarkCommand_CanExecute" Executed="DeleteRemarkCommand_Executed"/>
                            </TabItem.CommandBindings>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Orientation="Horizontal">
                                    <Button Content="分類追加" Width="75" Command="{StaticResource AddCategoryCommand}" ToolTip="Shift+Ctrl++"/>
                                    <Button Content="項目追加" Width="75" Command="{StaticResource AddItemCommand}" ToolTip="Ctrl++"/>
                                    <Button Content="削除" Width="50" Command="{StaticResource DeleteItemCommand}" ToolTip="Delete"/>
                                    <Button Content="↑" Width="25" Command="{StaticResource RaiseItemSortOrderCommand}" ToolTip="Ctrl+↑"/>
                                    <Button Content="↓" Width="25" Command="{StaticResource DropItemSortOrderCommand}" ToolTip="Ctrl+↓"/>
                                </StackPanel>
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="0.3*"/>
                                        <ColumnDefinition Width="0.6*"/>
                                    </Grid.ColumnDefinitions>

                                    <GroupBox Header="項目一覧">
                                        <TreeView x:Name="hierachicalTreeView" Grid.Column="0" Margin="5" ItemsSource="{Binding HierachicalItemVMList}"
                                                  SelectedItemChanged="TreeView_SelectedItemChanged">
                                            <TreeView.InputBindings>
                                                <KeyBinding Gesture="Shift+Ctrl+OEMPlus" Command="{StaticResource AddCategoryCommand}"/>
                                                <KeyBinding Gesture="Shift+Ctrl+Add" Command="{StaticResource AddCategoryCommand}"/>
                                                <KeyBinding Gesture="Ctrl+OEMPlus" Command="{StaticResource AddItemCommand}"/>
                                                <KeyBinding Gesture="Ctrl+Add" Command="{StaticResource AddItemCommand}"/>
                                                <KeyBinding Gesture="Delete" Command="{StaticResource DeleteItemCommand}"/>
                                                <KeyBinding Gesture="Ctrl+Up" Command="{StaticResource RaiseItemSortOrderCommand}"/>
                                                <KeyBinding Gesture="Ctrl+Down" Command="{StaticResource DropItemSortOrderCommand}"/>
                                            </TreeView.InputBindings>
                                            <TreeView.ItemContainerStyle>
                                                <Style TargetType="TreeViewItem">
                                                    <Setter Property="IsExpanded" Value="True"/>
                                                    <Setter Property="IsSelected" Value="{Binding IsSelected}" />
                                                </Style>
                                            </TreeView.ItemContainerStyle>
                                            <i:Interaction.Behaviors>
                                                <behaviors:BindSelectedItemToTreeViewBehavior SelectedItem="{Binding SelectedItemVM}"/>
                                            </i:Interaction.Behaviors>
                                            <TreeView.ItemTemplate>
                                                <HierarchicalDataTemplate DataType="viewmodels:SettingsViewModel.HierachicalItemViewModel" 
                                                                          ItemsSource="{Binding ChildrenVMList}">
                                                    <TextBlock Text="{Binding Name}" />
                                                </HierarchicalDataTemplate>
                                            </TreeView.ItemTemplate>
                                        </TreeView>
                                    </GroupBox>
                                    
                                    <Grid Grid.Column="1" DataContext="{Binding SelectedItemVM}">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="0.3*"/>
                                            <RowDefinition Height="0.3*"/>
                                            <RowDefinition Height="0.3*"/>
                                        </Grid.RowDefinitions>

                                        <GroupBox Grid.Row="0" Header="項目情報">
                                            <GroupBox.InputBindings>
                                                <KeyBinding Gesture="Ctrl+S" Command="{StaticResource SaveItemInfoCommand}"/>
                                            </GroupBox.InputBindings>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="0.5*"/>
                                                    <ColumnDefinition Width="0.5*"/>
                                                </Grid.ColumnDefinitions>

                                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="5" Text="帳簿名"/>
                                                <TextBox Grid.Row="0" Grid.Column="1" Margin="5" 
                                                        Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="{Binding CantRename}"/>
                                                <Button Grid.Row="1" Grid.Column="1" Margin="5,0" Content="確定" Command="{StaticResource SaveItemInfoCommand}" ToolTip="Ctrl+S"/>
                                            </Grid>
                                        </GroupBox>

                                        <GroupBox Grid.Row="1" Header="関連付け">
                                            <ListBox ItemsSource="{Binding RelationVMList}" SelectedItem="{Binding SelectedRelationVM}" IsEnabled="{Binding IsEnabled}">
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <CheckBox Grid.Column="0" IsChecked="{Binding IsRelated}" Command="{StaticResource ChangeItemRelationCommand}"/>
                                                            <TextBlock Grid.Column="1" Text="{Binding Name}"/>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </GroupBox>

                                        <GroupBox Grid.Row="2" Header="店舗">
                                            <ListBox x:Name="shopNameListBox" 
                                                ItemsSource="{Binding ShopNameList}" SelectedItem="{Binding SelectedShopName}" IsEnabled="{Binding IsEnabled}">
                                                <ListBox.InputBindings>
                                                    <KeyBinding Gesture="Delete" Command="{StaticResource DeleteShopNameCommand}"/>
                                                </ListBox.InputBindings>
                                            </ListBox>
                                        </GroupBox>

                                        <GroupBox Grid.Row="3" Header="備考">
                                            <ListBox x:Name="remarkListBox" 
                                                    ItemsSource="{Binding RemarkList}" SelectedItem="{Binding SelectedRemark}" IsEnabled="{Binding IsEnabled}">
                                                <ListBox.InputBindings>
                                                    <KeyBinding Gesture="Delete" Command="{StaticResource DeleteRemarkCommand}"/>
                                                </ListBox.InputBindings>
                                            </ListBox>
                                        </GroupBox>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="帳簿設定">
                            <TabItem.Resources>
                                <!-- 帳簿設定操作コマンド -->
                                <RoutedCommand x:Key="AddBookCommand"/>
                                <RoutedCommand x:Key="DeleteBookCommand"/>
                                <RoutedCommand x:Key="RaiseBookSortOrderCommand"/>
                                <RoutedCommand x:Key="DropBookSortOrderCommand"/>
                                <RoutedCommand x:Key="SaveBookInfoCommand"/>
                                <RoutedCommand x:Key="ChangeBookRelationCommand"/>
                            </TabItem.Resources>
                            <TabItem.CommandBindings>
                                <!-- 帳簿設定操作コマンド -->
                                <CommandBinding Command="{StaticResource AddBookCommand}" Executed="AddBookCommand_Executed"/>
                                <CommandBinding Command="{StaticResource DeleteBookCommand}" CanExecute="DeleteBookCommand_CanExecute" Executed="DeleteBookCommand_Executed"/>
                                <CommandBinding Command="{StaticResource RaiseBookSortOrderCommand}" CanExecute="RaiseBookSortOrderCommand_CanExecute" Executed="RaiseBookSortOrderCommand_Executed"/>
                                <CommandBinding Command="{StaticResource DropBookSortOrderCommand}" CanExecute="DropBookSortOrderCommand_CanExecute" Executed="DropBookSortOrderCommand_Executed"/>
                                <CommandBinding Command="{StaticResource SaveBookInfoCommand}" CanExecute="SaveBookInfoCommand_CanExecute" Executed="SaveBookInfoCommand_Executed"/>
                                <CommandBinding Command="{StaticResource ChangeBookRelationCommand}" Executed="ChangeBookRelationCommand_Executed"/>
                            </TabItem.CommandBindings>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Orientation="Horizontal">
                                    <Button Content="追加" Width="50" Command="{StaticResource AddBookCommand}" ToolTip="Ctrl++"/>
                                    <Button Content="削除" Width="50" Command="{StaticResource DeleteBookCommand}" ToolTip="Delete"/>
                                    <Button Content="↑" Width="25" Command="{StaticResource RaiseBookSortOrderCommand}" ToolTip="Ctrl+↑"/>
                                    <Button Content="↓" Width="25" Command="{StaticResource DropBookSortOrderCommand}" ToolTip="Ctrl+↓"/>
                                </StackPanel>
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="0.3*"/>
                                        <ColumnDefinition Width="0.6*"/>
                                    </Grid.ColumnDefinitions>

                                    <GroupBox Header="帳簿一覧">
                                        <ListBox Grid.Column="0" Margin="5" 
                                             ItemsSource="{Binding BookVMList}" SelectedItem="{Binding SelectedBookVM}" DisplayMemberPath="Name">
                                            <ListBox.InputBindings>
                                                <KeyBinding Gesture="Ctrl+OEMPlus" Command="{StaticResource AddBookCommand}"/>
                                                <KeyBinding Gesture="Ctrl+Add" Command="{StaticResource AddBookCommand}"/>
                                                <KeyBinding Gesture="Delete" Command="{StaticResource DeleteBookCommand}"/>
                                                <KeyBinding Gesture="Ctrl+Up" Command="{StaticResource RaiseBookSortOrderCommand}"/>
                                                <KeyBinding Gesture="Ctrl+Down" Command="{StaticResource DropBookSortOrderCommand}"/>
                                            </ListBox.InputBindings>
                                        </ListBox>
                                    </GroupBox>

                                    <Grid Grid.Column="1" DataContext="{Binding SelectedBookVM}">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="1.0*"/>
                                        </Grid.RowDefinitions>

                                        <GroupBox Header="帳簿情報">
                                            <GroupBox.InputBindings>
                                                <KeyBinding Gesture="Ctrl+S" Command="{StaticResource SaveBookInfoCommand}"/>
                                            </GroupBox.InputBindings>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="0.5*"/>
                                                    <ColumnDefinition Width="0.5*"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="5" Text="帳簿名"/>
                                                <TextBox Grid.Row="0" Grid.Column="1" Margin="5" 
                                                         Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>

                                                <TextBlock Grid.Row="1" Grid.Column="0" Margin="5" Text="帳簿種別"/>
                                                <ComboBox Grid.Row="1" Grid.Column="1" Margin="5" 
                                                          ItemsSource="{Binding BookKindDic}" SelectedValue="{Binding SelectedBookKind}" SelectedValuePath="Key" DisplayMemberPath="Value"/>

                                                <TextBlock Grid.Row="2" Grid.Column="0" Margin="5" Text="初期残高"/>
                                                <controls:NumericUpDown Grid.Row="2" Grid.Column="1" Margin="5" 
                                                                        Value="{Binding InitialValue}"/>

                                                <TextBlock Grid.Row="3" Grid.Column="0" Margin="5" Text="支払元帳簿"/>
                                                <ComboBox Grid.Row="3" Grid.Column="1" Margin="5" IsEnabled="{Binding NeedToPay}" 
                                                          ItemsSource="{Binding DebitBookVMList}" SelectedItem="{Binding SelectedDebitBookVM}" DisplayMemberPath="Name"/>

                                                <TextBlock Grid.Row="4" Grid.Column="0" Margin="5" Text="支払日"/>
                                                <controls:NumericUpDown Grid.Row="4" Grid.Column="1" Margin="5" MinValue="1" MaxValue="31" 
                                                                        Value="{Binding PayDay, TargetNullValue=''}" IsEnabled="{Binding NeedToPay}"/>
                                                <Button Grid.Row="5" Grid.Column="1" Margin="5,0" Content="確定" Command="{StaticResource SaveBookInfoCommand}" ToolTip="Ctrl+S"/>
                                            </Grid>
                                        </GroupBox>
                                        
                                        <GroupBox Grid.Row="1" Header="関連付け">
                                            <Grid>
                                                <ListBox Margin="5" ItemsSource="{Binding RelationVMList}" SelectedItem="{Binding SelectedRelationVM}">
                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>
                                                                <CheckBox Grid.Column="0" IsChecked="{Binding IsRelated}" Command="{StaticResource ChangeBookRelationCommand}"/>
                                                                <TextBlock Grid.Column="1" Text="{Binding Name}"/>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                </ListBox>
                                            </Grid>
                                        </GroupBox>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="その他">
                            <TabItem.Resources>
                                <RoutedCommand x:Key="DumpExePathDialogCommand"/>
                                <RoutedCommand x:Key="RestoreExePathDialogCommand"/>
                                <RoutedCommand x:Key="RestartForDbSettingCommand"/>
                                <RoutedCommand x:Key="BackUpFolderPathDialogCommand"/>
                            </TabItem.Resources>
                            <TabItem.CommandBindings>
                                <CommandBinding Command="{StaticResource DumpExePathDialogCommand}"
                                                Executed="DumpExePathDialogCommand_Executed"/>
                                <CommandBinding Command="{StaticResource RestoreExePathDialogCommand}"
                                                Executed="RestorePathDialogCommand_Executed"/>
                                <CommandBinding Command="{StaticResource RestartForDbSettingCommand}"
                                                Executed="RestartForDbSettingCommand_Executed"/>
                                <CommandBinding Command="{StaticResource BackUpFolderPathDialogCommand}"
                                                Executed="BackUpFolderPathDialogCommand_Executed"/>
                            </TabItem.CommandBindings>
                            <ScrollViewer>
                                <StackPanel Grid.IsSharedSizeScope="True">
                                    <GroupBox Header="データベース">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" SharedSizeGroup="Header"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="30" SharedSizeGroup="Button"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="pg_dump.exe" Margin="5" VerticalAlignment="Center"/>
                                            <TextBox Grid.Row="0" Grid.Column="1" Margin="5" Text="{Binding DumpExePath}" IsReadOnly="True"/>
                                            <Button Grid.Row="0" Grid.Column="2" Margin="5" Content="..." Command="{StaticResource DumpExePathDialogCommand}"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="pg_restore.exe" Margin="5" VerticalAlignment="Center"/>
                                            <TextBox Grid.Row="1" Grid.Column="1" Margin="5" Text="{Binding RestoreExePath}" IsReadOnly="True"/>
                                            <Button Grid.Row="1" Grid.Column="2" Margin="5" Content="..." Command="{StaticResource RestoreExePathDialogCommand}"/>

                                            <Button Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Margin="5" Content="データベース通信設定を再登録する(再起動)"
                                                    Command="{StaticResource RestartForDbSettingCommand}"/>
                                        </Grid>
                                    </GroupBox>
                                    <GroupBox Header="バックアップ">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition SharedSizeGroup="Header"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition SharedSizeGroup="Button"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="バックアップの個数" Margin="5" VerticalAlignment="Center"/>
                                            <controls:NumericUpDown Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="5" MinValue="0" MaxValue="100" Value="{Binding BackUpNum}"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="バックアップ先フォルダ" Margin="5" VerticalAlignment="Center"/>
                                            <TextBox Grid.Row="1" Grid.Column="1" Margin="5" Text="{Binding BackUpFolderPath}" IsReadOnly="True"/>
                                            <Button Grid.Row="1" Grid.Column="2" Margin="5" Content="..." Command="{StaticResource BackUpFolderPathDialogCommand}"/>
                                        </Grid>
                                    </GroupBox>
                                    <GroupBox Header="カレンダー">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition SharedSizeGroup="Header"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition SharedSizeGroup="Button"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="開始月" Margin="5" VerticalAlignment="Center"/>
                                            <controls:NumericUpDown Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="5" MinValue="1" MaxValue="12" Value="{Binding StartMonth}"/>
                                        </Grid>
                                    </GroupBox>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
